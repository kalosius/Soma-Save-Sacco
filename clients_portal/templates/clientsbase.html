{% load static %}
{% load pwa %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard - SomaSave SACCO</title>
  <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">

  <!-- pwa -->
  <link rel="manifest" href="{% static 'manifest.json' %}">
  <link rel="icon" href="{% static 'icons/icon-192x192.png' %}" type="image/png">
    <link rel="canonical" href="https://somasave.com/">

  <meta name="theme-color" content="#0d6efd">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script src="{% static 'js/sw.js' %}"></script>


  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    function toggleMenu() {
      document.getElementById("mobile-menu").classList.toggle("hidden");
    }
  </script>



    <!-- SEO -->
    <!-- Primary Meta Tags -->
<meta name="title" content="SomaSave SACCO – Empowering Students with a Savings Culture">
<meta name="description" content="SomaSave SACCO is a smart digital savings platform designed for university students in Uganda. Empower your financial future, save easily, and grow your money with purpose.">
<meta name="keywords" content="SomaSave, SACCO, student savings, Uganda, university students, saving culture, digital banking, SomaSave Uganda">
<meta name="author" content="SomaSave Tech Team">


<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://somasave.com/">
<meta property="og:title" content="SomaSave SACCO – Empowering Students with a Savings Culture">
<meta property="og:description" content="A SACCO made for students to build strong financial habits. Join SomaSave and start saving smart.">
<meta property="og:image" content="https://somasave.com/static/images/social-banner.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://somasave.com/">
<meta property="twitter:title" content="SomaSave SACCO – Empowering Students with a Savings Culture">
<meta property="twitter:description" content="University students in Uganda can now save, grow, and learn smart financial habits through SomaSave.">
<meta property="twitter:image" content="https://somasave.com/static/images/social-banner.png">


</head>
<body class="bg-gray-100 text-gray-800 font-sans">

  <!-- Header Navigation -->
  <header class="bg-white shadow-md">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16 items-center">
        <!-- Logo -->
        <div class="flex items-center space-x-2">
          <img src="{% static 'images/img/logo.png' %}" alt="Logo" class="w-8 h-8" />
          <span class="font-bold text-lg">SomaSave SACCO</span>
        </div>

        <!-- Desktop Menu -->
        <nav class="hidden md:flex space-x-6 text-sm font-medium">
          <a href="{% url 'client_dashboard' %}" class="hover:text-blue-600">Dashboard</a>
          <a href="{% url 'userprofile' %}" class="hover:text-blue-600">My Profile</a>
          <a href="{% url 'account' %}" class="hover:text-blue-600">Accounts</a>
          <a href="{% url 'user_loans' %}" class="hover:text-blue-600">Loans</a>
          <!-- <a href="{% url 'shares' %}" class="hover:text-blue-600">Shares</a> -->
          <a href="{% url 'statement' %}" class="hover:text-blue-600">My Statement</a>
          <!-- <a href="{% url 'loanrequest' %}" class="hover:text-blue-600">Loan Requests</a> -->
          {% comment %} <a href="{% url 'withdrawal' %}" class="hover:text-blue-600">Withdraw Requests</a> {% endcomment %}
          <a href="{% url 'transactions' %}" class="hover:text-blue-600">Transactions</a>
          <a href="#" onclick="showLogoutCard(event)" class="block text-red-500">Log Out</a>
    </nav>

        <!-- Mobile menu button -->
        <div class="md:hidden">
          <button onclick="toggleMenu()" class="text-gray-700 focus:outline-none">
            <svg class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2"
                 viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- mobile menu -->
<div id="mobile-menu" class="md:hidden hidden px-4 pb-4 text-sm">
  <ul class="space-y-3">
    
    <li>
      <a href="{% url 'client_dashboard' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-4 0h4"></path>
        </svg>
        <span>Dashboard</span>
      </a>
    </li>

    <li>
      <a href="{% url 'userprofile' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5.121 17.804A7 7 0 0112 15a7 7 0 016.879 2.804M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>
        <span>My Profile</span>
      </a>
    </li>

    <li>
      <a href="{% url 'account' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M4 6h16M4 14h16M4 18h16"></path>
        </svg>
        <span>Accounts</span>
      </a>
    </li>

    <li>
      <a href="{% url 'user_loans' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 1.567-3 3.5S10.343 15 12 15s3-1.567 3-3.5S13.657 8 12 8zM12 3v2m0 14v2m9-9h-2m-14 0H3"></path>
        </svg>
        <span>Loans</span>
      </a>
    </li>

    {% if user.is_superuser %}
    <li>
      <a href="{% url 'shares' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <span>Shares</span>
      </a>
    </li>
    <li>
      <a href="{% url 'admin_login' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
        <span>Admin Portal</span>
      </a>
    </li>
    {% endif %}

    <li>
      <a href="{% url 'statement' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 17v-2a4 4 0 00-4-4H3m6 6h6a4 4 0 014 4v2m0-2h2a2 2 0 002-2v-4a2 2 0 00-2-2h-2M7 9h10"></path>
        </svg>
        <span>My Statement</span>
      </a>
    </li>

    <li>
      <a href="{% url 'loanrequest' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
        </svg>
        <span>Loan Requests</span>
      </a>
    </li>

    {% comment %} <li>
      <a href="{% url 'withdrawal' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M17 9V7a4 4 0 00-8 0v2m1 4h6m2 0a2 2 0 11-4 0 2 2 0 114 0z"></path>
        </svg>
        <span>Withdraw Requests</span>
      </a>
    </li> {% endcomment %}

    <li>
      <a href="{% url 'transactions' %}" class="flex items-center space-x-2 menu-item px-3 py-2 rounded hover:bg-green-200">
        <svg class="h-5 w-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h18M4 6h16M4 14h16M4 18h16"></path>
        </svg>
        <span>Transactions</span>
      </a>
    </li>

    <li>
      <a href="#" onclick="showLogoutCard(event)" class="flex items-center space-x-2 px-3 py-2 rounded text-red-500 hover:bg-red-200">
        <svg class="h-5 w-5 text-red-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 11-4 0v-1m0-8V7a2 2 0 114 0v1"></path>
        </svg>
        <span>Log Out</span>
      </a>
    </li>

  </ul>
</div>




<!-- Bottom Mobile Navigation Bar -->
<nav class="fixed bottom-0 left-0 right-0 z-50 bg-white shadow-md border-t sm:hidden">
  <div class="flex justify-around items-center py-2">
    <!-- Home -->
    <a href="{% url 'client_dashboard' %}" onclick="showSpinner(); autoHideSpinner();" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10l9-7 9 7v10a2 2 0 01-2 2H5a2 2 0 01-2-2V10z" />
      </svg>
      <span class="text-xs">Home</span>
    </a>
    
    <!-- Transactions -->
    <a href="{% url 'transactions' %}" onclick="showSpinner(); autoHideSpinner();" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a4 4 0 00-8 0v2m1 4h6m-3 4v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z" />
      </svg>
      <span class="text-xs">Transactions</span>
    </a>

    <!-- Loans -->
    <a href="{% url 'user_loans' %}" onclick="showSpinner(); autoHideSpinner();" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span class="text-xs">Loans</span>
    </a>

    <!-- Profile or More -->
    <a href="{% url 'userprofile' %}" onclick="showSpinner(); autoHideSpinner();" class="flex flex-col items-center text-gray-600 hover:text-blue-600">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A8.966 8.966 0 0112 15a8.966 8.966 0 016.879 2.804M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
      <span class="text-xs">Profile</span>
    </a>
  </div>
</nav>


<script>
  // Wait for DOM content loaded
  document.addEventListener('DOMContentLoaded', () => {
    const menuLinks = document.querySelectorAll('#mobile-menu a.menu-item');
    
    menuLinks.forEach(link => {
      link.addEventListener('click', () => {
        // Remove bg-green-600 from all
        menuLinks.forEach(l => l.classList.remove('bg-green-100', 'text-white'));
        
        // Add bg-green-600 and white text to clicked link
        link.classList.add('bg-green-600', 'text-white');
      });
    });
  });
</script>

  </header>

  <!-- Main Content -->
    {% block content %}
    {% endblock %}



    <div id="logoutCard" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg transform transition-all scale-95 opacity-0 duration-300 max-w-sm w-full text-center" id="logoutCardInner">
    <h2 class="text-lg font-semibold mb-4">Are you sure you want to log out?</h2>
    <form method="post" action="{% url 'logout' %}" onsubmit="showLogoutSpinner()">
      {% csrf_token %}
      <div class="flex justify-center gap-4">
<button type="submit" id="logoutConfirmBtn" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded flex items-center justify-center">
  <span class="btn-text">Yes, Log Out</span>
  <svg class="spinner hidden animate-spin h-5 w-5 ml-2 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" />
    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" />
  </svg>
</button>
        <button type="button" onclick="hideLogoutCard()" class="bg-gray-300 hover:bg-gray-400 text-black px-4 py-2 rounded">Cancel</button>
      </div>
    </form>
  </div>
</div>


<script>
  function showLogoutCard(event) {
    event.preventDefault();
    const card = document.getElementById('logoutCard');
    const inner = document.getElementById('logoutCardInner');
    card.classList.remove('hidden');
    setTimeout(() => {
      inner.classList.add('scale-100', 'opacity-100');
      inner.classList.remove('scale-95', 'opacity-0');
    }, 10);
  }

  function hideLogoutCard() {
    const card = document.getElementById('logoutCard');
    const inner = document.getElementById('logoutCardInner');
    inner.classList.add('scale-95', 'opacity-0');
    inner.classList.remove('scale-100', 'opacity-100');
    setTimeout(() => {
      card.classList.add('hidden');
    }, 300); // match transition duration
  }
</script>

<!-- spinnerjs -->
<script>
  function showLogoutSpinner() {
    const btn = document.getElementById('logoutConfirmBtn');
    btn.disabled = true;
    btn.querySelector('.btn-text').classList.add('hidden');
    btn.querySelector('.spinner').classList.remove('hidden');
  }
</script>





<!-- New Feature Modal -->
<div id="feature-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md mx-4 relative">
    <button onclick="closeFeatureModal()" class="absolute top-2 right-2 text-gray-400 hover:text-red-600 text-xl font-bold">&times;</button>
    <h3 class="text-xl font-bold text-gray-800 mb-3">🎉 What’s New</h3>
    <ul class="list-disc pl-5 space-y-2 text-gray-700 text-sm">
      <li>📦 You can now Install the Android and IOS app</li>
      <li>💸 You can now withdraw via MTN and Airtel with logos!</li>
      <li>📊 Improved dashboard with live financial summary.</li>
      <li>🕒 Smart greeting messages based on time of day.</li>
      <li>Access to your personal statements. Wow!!</li>
    </ul>
    <div class="mt-5 text-right">
      <button onclick="closeFeatureModal()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Got it!</button>
    </div>
  </div>
</div>

<script>
  const FEATURE_VERSION = "v1.3.1"; // Change this on each feature update

  function showFeatureModal() {
    document.getElementById('feature-modal').classList.remove('hidden');
  }

  function closeFeatureModal() {
    document.getElementById('feature-modal').classList.add('hidden');
    localStorage.setItem('seenFeatureVersion', FEATURE_VERSION);
  }

  // Show modal if this version hasn't been seen
  window.addEventListener('DOMContentLoaded', () => {
    const seenVersion = localStorage.getItem('seenFeatureVersion');
    if (seenVersion !== FEATURE_VERSION) {
      showFeatureModal();
    }
  });
</script>












<!-- PWA -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', function () {
      navigator.serviceWorker.register("{% static 'js/sw.js' %}")
        .then(function (registration) {
          console.log('Service Worker registered with scope:', registration.scope);
        })
        .catch(function (error) {
          console.error('Service Worker registration failed:', error);
        });
    });
  }
</script>





<!-- Spinner Modal -->
<div id="spinnerModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-blue-600"></div>
</div>


<script>
  function showSpinner() {
    document.getElementById('spinnerModal').classList.remove('hidden');
  }

  function hideSpinner() {
    document.getElementById('spinnerModal').classList.add('hidden');
  }

  // Automatically hide spinner after 3 seconds (optional fallback)
  function autoHideSpinner() {
    setTimeout(() => {
      hideSpinner();
    }, 3000);
  }
</script>

</body>
</html>
